import{r as Z,j as e}from"./index-Bo_1Zqy6.js";import{B as oe,a as te}from"./ButtonsModal-rjNumsnu.js";import{B as le}from"./BaseTable-CG0hieRc.js";import{M as ne}from"./ModalDelete-C1zEzITC.js";import{u as $,a as ee,I as i}from"./InputField-Bgiqn5r0.js";import{u as P}from"./usePaymentPlayerStore-D50X6ePz.js";import{u as se}from"./usePlayerStore-DQgVyjp1.js";import{A as q}from"./AlertaCard-Y7DSOmzU.js";import{C as re}from"./CancelButtonModal-C6qEQDgJ.js";import{C as z}from"./CardAbonos-Be5ujqqa.js";import"./dayjs.min-C6mA835O.js";import"./chevron-right-BHG4n6AS.js";import"./players-CfGsYTWQ.js";import"./es-BFm7WDBc.js";import"./square-pen-C_HaDAF2.js";import"./eye-DdfdWaaB.js";import"./categorias-DKNPRs5G.js";import"./caja-BNiab2HZ.js";import"./historial-K5E-8qry.js";import"./calendar-D-tR41jb.js";const ae=()=>{const t=$(o=>o.modalType),n=$(o=>o.formData),a=$(o=>o.setNestedFormData),y=$(o=>o.closeModal),d=P(o=>o.loading),S=P(o=>o.payments),x=P(o=>o.getDataPaymentsPlayer),C=P(o=>o.addPayment),w=P(o=>o.editPayment),B=P(o=>o.deletePayment),O=se(o=>o.getDataPlayers);return Z.useEffect(()=>{var o,p,F,T,M,D,E,s,r,l,j,v,u,c,m,b,g,f,h,_,N,I,A,G,H,K,L,Q,V,W,X,Y;a("pagos.0.tipo","Inscripción"),a("pagos.1.tipo","Equipamiento"),a("pagos.2.tipo","Pesaje"),(p=(o=n.pagos)==null?void 0:o[0])!=null&&p.beca||a("pagos.0.beca","0"),(T=(F=n.pagos)==null?void 0:F[0])!=null&&T.descuento||a("pagos.0.descuento","0"),(D=(M=n.pagos)==null?void 0:M[0])!=null&&D.prorroga||a("pagos.0.prorroga","false"),(s=(E=n.pagos)==null?void 0:E[0])!=null&&s.fecha_limite||a("pagos.0.fecha_limite"),(l=(r=n.pagos)==null?void 0:r[0])!=null&&l.total_abonado||a("pagos.0.total_abonado","0"),(v=(j=n.pagos)==null?void 0:j[1])!=null&&v.total_abonado||a("pagos.1.total_abonado","0"),(c=(u=n.pagos)==null?void 0:u[2])!=null&&c.total_abonado||a("pagos.2.total_abonado","0"),(b=(m=n.pagos)==null?void 0:m[0])!=null&&b.estatus||a("pagos.0.estatus","pendiente"),(f=(g=n.pagos)==null?void 0:g[1])!=null&&f.estatus||a("pagos.1.estatus","pendiente"),(_=(h=n.pagos)==null?void 0:h[2])!=null&&_.estatus||a("pagos.2.estatus","pendiente"),(I=(N=n.pagos)==null?void 0:N[0])!=null&&I.fecha_pago||a("pagos.0.fecha_pago",null),(G=(A=n.pagos)==null?void 0:A[1])!=null&&G.fecha_pago||a("pagos.1.fecha_pago",null),(K=(H=n.pagos)==null?void 0:H[2])!=null&&K.fecha_pago||a("pagos.2.fecha_pago",null),(Q=(L=n.pagos)==null?void 0:L[0])!=null&&Q.metodo_pago||a("pagos.0.metodo_pago",null),(W=(V=n.pagos)==null?void 0:V[1])!=null&&W.metodo_pago||a("pagos.1.metodo_pago",null),(Y=(X=n.pagos)==null?void 0:X[2])!=null&&Y.metodo_pago||a("pagos.2.metodo_pago",null)},[n.pagos,a]),{payments:S,getDataPaymentsPlayer:x,loading:d,handleSubmit:async o=>{o.preventDefault();try{t==="add"?await C(n):t==="edit"&&await w(n)}catch(p){console.log(p)}finally{y()}},handleDelete:async o=>{await B(o),y()},loadOptions:async()=>{try{return(await O()).map(p=>({value:p.id,label:`${p.nombre} ${p.apellido_p} ${p.apellido_m}`}))}catch(o){return console.error("Error loading users:",o),[]}}}},k={inscriptionFields:[{required:!0,type:"number",label:"Beca (%) *",name:"beca"},{required:!0,type:"number",label:"Descuento por equipo propio (%) *",name:"descuento"},{required:!0,type:"select",label:"Estatus *",name:"estatus",opcSelect:[{value:"pendiente",label:"Pendiente"},{value:"pagado",label:"Pagado"}]},{required:!0,type:"number",label:"Submonto *",name:"submonto"},{required:!0,type:"number",label:"Monto final *",name:"monto"},{required:!1,type:"select",label:"Método de pago (si no se ha pagado, dejar vacía)",name:"metodo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}]},{required:!0,type:"select",label:"Prorroga *",name:"prorroga",opcSelect:[{value:"false",label:"No"},{value:"true",label:"Sí"}]},{required:!0,type:"date",label:"Fecha límite de pago *",name:"fecha_limite",condition:t=>t.prorroga==="true"},{required:!1,type:"date",label:"Fecha de pago (si no se ha pagado, dejar vacía)",name:"fecha_pago"},{required:!1,type:"select",label:"¿Abonará? *",name:"abono",opcSelect:[{value:"NO",label:"No"},{value:"SI",label:"Sí"}]},{required:!1,type:"number",label:"Total abonado",name:"total_abonado"}],equipamientoFields:[{required:!0,type:"select",label:"Estatus *",name:"estatus",opcSelect:[{value:"pendiente",label:"Pendiente"},{value:"pagado",label:"Pagado"}]},{required:!0,type:"number",label:"Monto total *",name:"monto"},{required:!1,type:"date",label:"Fecha del último pago (si no se ha pagado, dejar vacía)",name:"fecha_pago"},{required:!1,type:"select",label:"Método de pago (si no se ha pagado, dejar vacía)",name:"metodo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}]},{required:!1,type:"select",label:"¿Abonará? *",name:"abono",opcSelect:[{value:"NO",label:"No"},{value:"SI",label:"Sí"}]},{required:!1,type:"number",label:"Total abonado",name:"total_abonado"}],pesajeFields:[{required:!0,type:"select",label:"Estatus *",name:"estatus",opcSelect:[{value:"pendiente",label:"Pendiente"},{value:"pagado",label:"Pagado"}]},{required:!0,type:"number",label:"Monto total *",name:"monto"},{required:!1,type:"date",label:"Fecha de pago (si no se ha pagado, dejar vacía)",name:"fecha_pago"},{required:!1,type:"select",label:"Método de pago (si no se ha pagado, dejar vacía)",name:"metodo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}]},{required:!1,type:"select",label:"¿Abonará? *",name:"abono",opcSelect:[{value:"NO",label:"No"},{value:"SI",label:"Sí"}]},{required:!1,type:"number",label:"Total abonado",name:"total_abonado"}],paymentsFields:[{required:!1,type:"number",label:"Total pagado *",name:"monto_total_pagado"},{required:!1,type:"number",label:"Total pendiente *",name:"monto_total_pendiente"},{required:!0,type:"number",label:"Monto Total *",name:"monto_total"}]},de=()=>{var x,C,w,B,O,J,U,R,o,p,F,T,M,D,E;const{view:t,document:n,formData:a,handleNestedInputChange:y,handleInputChange:d}=ee(),{loadOptions:S}=ae();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx(q,{text:"Jugador"}),e.jsx(i,{type:"async",label:"Selecciona el jugador",name:"jugador",required:!0,value:a.jugador||"",onChange:d,disabled:n?!0:t,loadOptions:S,classInput:"md:col-span-2"}),e.jsx(q,{text:"Pago de inscripción"}),k.inscriptionFields.map(({type:s,label:r,name:l,required:j,opcSelect:v,condition:u,value:c})=>{var m,b,g,f,h,_,N,I,A;return(!u||u(((m=a.pagos)==null?void 0:m[0])||{}))&&e.jsx(i,{type:s,label:r,required:((g=(b=a.pagos)==null?void 0:b[0])==null?void 0:g.estatus)==="pagado"?!0:j,opcSelect:v,name:`pagos.0.${l}`,value:c||(((h=(f=a.pagos)==null?void 0:f[0])==null?void 0:h[l])??""),onChange:y,disabled:["monto","total_abonado"].includes(l)||((N=(_=a.pagos)==null?void 0:_[0])==null?void 0:N.total_abonado)>=((A=(I=a.pagos)==null?void 0:I[0])==null?void 0:A.monto)&&l==="abono"?!0:t},l)}),((C=(x=a.pagos)==null?void 0:x[0])==null?void 0:C.abono)==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{type:"number",label:"Cantidad abonada *",required:!0,name:"cantidad_abono_ins",value:a.cantidad_abono_ins??"",onChange:d,disabled:t}),e.jsx(i,{type:"date",label:"Fecha del abono *",required:!0,name:"fecha_abono_ins",value:a.fecha_abono_ins??"",onChange:d,disabled:t}),e.jsx(i,{type:"select",label:"Método de pago *",required:!0,name:"metodo_pago_abono_ins",value:a.metodo_pago_abono_ins??"",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}],onChange:d,disabled:t})]}),((O=(B=(w=a.pagos)==null?void 0:w[0])==null?void 0:B.abonos)==null?void 0:O.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(q,{text:"Abonos de inscripción"}),a.pagos[0].abonos.map((s,r)=>e.jsxs(e.Fragment,{children:[e.jsx(z,{amount:s.cantidad,date:s.fecha,method:s.metodo},r),e.jsx("hr",{className:"sm:grid-cols-3 gap-2 md:col-span-2"})]}))]}),e.jsx(q,{text:"Pago de equipamiento"}),k.equipamientoFields.map(({type:s,label:r,name:l,required:j,opcSelect:v})=>{var u,c,m,b,g,f,h,_;return e.jsx(i,{type:s,label:r,required:((c=(u=a.pagos)==null?void 0:u[1])==null?void 0:c.estatus)==="pagado"?!0:j,opcSelect:v,name:`pagos.1.${l}`,value:((b=(m=a.pagos)==null?void 0:m[1])==null?void 0:b[l])??"",onChange:y,disabled:["monto","total_abonado"].includes(l)||((f=(g=a.pagos)==null?void 0:g[1])==null?void 0:f.total_abonado)>=((_=(h=a.pagos)==null?void 0:h[1])==null?void 0:_.monto)&&l==="abono"?!0:t},l)}),((U=(J=a.pagos)==null?void 0:J[1])==null?void 0:U.abono)==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{type:"number",label:"Cantidad abonada *",required:!0,name:"cantidad_abono_equipamiento",value:a.cantidad_abono_equipamiento??"",onChange:d,disabled:t}),e.jsx(i,{type:"date",label:"Fecha del abono *",required:!0,name:"fecha_abono_equipamiento",value:a.fecha_abono_equipamiento??"",onChange:d,disabled:t}),e.jsx(i,{type:"select",label:"Método de pago *",required:!0,name:"metodo_pago_abono_equipamiento",value:a.metodo_pago_abono_equipamiento??"",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}],onChange:d,disabled:t})]}),((p=(o=(R=a.pagos)==null?void 0:R[1])==null?void 0:o.abonos)==null?void 0:p.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(q,{text:"Abonos de equipamiento"}),a.pagos[1].abonos.map((s,r)=>e.jsxs(e.Fragment,{children:[e.jsx(z,{amount:s.cantidad,date:s.fecha,method:s.metodo},r),e.jsx("hr",{className:"sm:grid-cols-3 gap-2 md:col-span-2"})]}))]}),e.jsx(q,{text:"Pago de pesaje"}),k.pesajeFields.map(({type:s,label:r,name:l,required:j,opcSelect:v})=>{var u,c,m,b,g,f,h,_;return e.jsx(i,{type:s,label:r,required:((c=(u=a.pagos)==null?void 0:u[2])==null?void 0:c.estatus)==="pagado"?!0:j,opcSelect:v,name:`pagos.2.${l}`,value:((b=(m=a.pagos)==null?void 0:m[2])==null?void 0:b[l])??"",onChange:y,disabled:["monto","total_abonado"].includes(l)||((f=(g=a.pagos)==null?void 0:g[2])==null?void 0:f.total_abonado)>=((_=(h=a.pagos)==null?void 0:h[2])==null?void 0:_.monto)&&l==="abono"?!0:t},l)}),((T=(F=a.pagos)==null?void 0:F[2])==null?void 0:T.abono)==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{type:"number",label:"Cantidad abonada *",required:!0,name:"cantidad_abono_pesaje",value:a.cantidad_abono_pesaje??"",onChange:d,disabled:t}),e.jsx(i,{type:"date",label:"Fecha del abono *",required:!0,name:"fecha_abono_pesaje",value:a.fecha_abono_pesaje??"",onChange:d,disabled:t}),e.jsx(i,{type:"select",label:"Método de pago *",required:!0,name:"metodo_pago_abono_pesaje",value:a.metodo_pago_abono_pesaje??"",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}],onChange:d,disabled:t})]}),((E=(D=(M=a.pagos)==null?void 0:M[2])==null?void 0:D.abonos)==null?void 0:E.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(q,{text:"Abonos de pesaje"}),a.pagos[2].abonos.map((s,r)=>e.jsxs(e.Fragment,{children:[e.jsx(z,{amount:s.cantidad,date:s.fecha,method:s.metodo},r),e.jsx("hr",{className:"sm:grid-cols-3 gap-2 md:col-span-2"})]}))]}),e.jsx(q,{text:"Pagos"}),k.paymentsFields.map(({type:s,label:r,name:l,required:j,opcSelect:v})=>e.jsx(i,{type:s,label:r,required:j,opcSelect:v,name:l,value:a[l]??"",onChange:y,disabled:l==="monto_total"?!0:t},l))]}),e.jsx("hr",{className:"text-gray-300"}),t?e.jsx(re,{}):e.jsx(oe,{})]})},ie=[{key:"inscripcion",name:"Inscripción"},{key:"equipamiento",name:"Equipamiento"},{key:"pesaje",name:"Pesaje"},{key:"nombre",name:"Jugador"}];function De(){const{modalType:t,currentItem:n}=ee(),{payments:a,loading:y,getDataPaymentsPlayer:d,handleSubmit:S,handleDelete:x}=ae();return Z.useEffect(()=>{(async()=>await d())()},[d]),e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(le,{columns:ie,data:a,title:"Pagos de jugadores",loading:y}),(t==="add"||t==="edit"||t==="view")&&e.jsx(te,{handleSubmit:S,Inputs:e.jsx(de,{})}),t==="delete"&&n&&e.jsx(ne,{handleDelete:x})]})}export{De as default};
