import{h as i,e as c,u as j,T as D,k as y,d,o as I,i as P,t as $,n as Y,q,w as E,p as N}from"./index-1hkev0sT.js";import{d as R}from"./dayjs.min-Dodf3ejV.js";import{f as T}from"./costos-porrista-BRwTdeOH.js";const f=d(c,"jugadores"),v=d(c,"pagos_jugadores"),F=async e=>{try{const a={...e,fecha_registro:D.now()},o=(await y(f,a)).id,r=`${e.nombre} ${e.apellido_p} ${e.apellido_m}`,n=e.temporadaId,s=e.categoria;return await M(o,r,n,s),o}catch(a){console.error("Error al agregar jugador:",a)}},O=async e=>I(f,async a=>{const t=await Promise.all(a.docs.map(async o=>{const r=await w(o.data().uid),n=`${o.data().nombre} ${o.data().apellido_p} ${o.data().apellido_m}`;return{...o.data(),id:o.id,nombre_completo:n,uid:{value:o.data().uid,label:r==null?void 0:r.nombre_completo}}}));e(t)}),x=async e=>{try{const a=i(c,"jugadores",e),t=await Y(a);if(t.exists()){const o=t.data(),r=await w(o.uid),n=`${o.nombre} ${o.apellido_p} ${o.apellido_m}`;return{...o,id:t.id,nombre_completo:n,uid:{value:o.uid,label:r==null?void 0:r.nombre_completo}}}else return console.warn("No se encontr칩 el jugador con ese ID"),null}catch(a){return console.error("Error al obtener el jugador:",a),null}},B=async(e,a)=>{try{const t=i(c,"jugadores",e);await j(t,a)}catch(t){console.error("Error al actualizar jugador:",t)}},J=async e=>{try{const a=i(c,"jugadores",e);await P(a)}catch(a){console.error("Error al eliminar jugador:",a)}},w=async e=>{try{const a=d(c,"usuarios"),t=q(a,E("uid","==",e)),o=await N(t);return o.empty?(console.log("No se encontr칩 un usuario con ese ID."),null):o.docs[0].data()}catch(a){return console.error("Error buscando usuario:",a),null}},M=async(e,a,t,o)=>{var g,_,b;const r=R(),n=r.add(1,"week").format("YYYY/MM/DD"),s=await T(t);s.length===0&&$.warning("No se encontraron costos para esta temporada. Se usar치n valores por defecto.");const l=parseFloat((g=s[0])==null?void 0:g.inscripcion)||500,u=parseFloat((_=s[0])==null?void 0:_.equipamiento)||500,p=parseFloat((b=s[0])==null?void 0:b.pesaje)||500,m=l+u+p,h={jugadorId:e,nombre:a,temporadaId:t,categoria:o,pagos:[{tipo:"Inscripci칩n",beca:"0",descuento:"0",estatus:"pendiente",fecha_pago:null,submonto:l,monto:l,prorroga:!1,fecha_limite:n,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0},{tipo:"Equipamiento",estatus:"pendiente",fecha_pago:null,fecha_limite:null,monto:u,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0},{tipo:"Pesaje",estatus:"pendiente",fecha_pago:null,monto:p,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0}],monto_total_pagado:0,monto_total_pendiente:m,monto_total:m,fecha_registro:r.format("YYYY-MM-DD")};await y(v,h)};export{x as a,F as c,O as g,J as r,B as u};
