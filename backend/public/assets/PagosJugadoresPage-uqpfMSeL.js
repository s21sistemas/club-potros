import{r as re,t as pe,j as e}from"./index-1hkev0sT.js";import{B as ce,a as ue}from"./ButtonsModal-DwgSUSF5.js";import{B as me}from"./BaseTable-DI_i5Uvm.js";import{M as ge}from"./ModalDelete-BZuhmeM_.js";import{u as J,a as de,I as d}from"./InputField-GuZ0OZJf.js";import{u as S}from"./usePaymentPlayerStore-VxZMbW_I.js";import{u as be}from"./usePlayerStore-DIqhNAeE.js";import{u as fe}from"./useTemporadasStore-D6fgAS8s.js";import{u as he,F as je,B as ve}from"./useCalendarStore-D6rkXP-q.js";import{A as x}from"./AlertaCard-CkpJgsto.js";import{C as ye}from"./CancelButtonModal-BY77VJ91.js";import{C as X}from"./CardAbonos-Bk6zGDaS.js";import"./dayjs.min-Dodf3ejV.js";import"./chevron-right-CQV0O4Z1.js";import"./players-BzdLQVIf.js";import"./costos-porrista-BRwTdeOH.js";import"./es-rjeHZEeQ.js";import"./square-pen-Da5ptJOH.js";import"./eye-Brg_21Lh.js";import"./categorias-BT_gOMst.js";import"./caja-DXDVpJfs.js";import"./historial-ck_lK1Kp.js";import"./calendar-BvD9P78A.js";const ie=s=>{const _=fe(a=>a.getDataTemporadas),o=he(a=>a.getPlayersByTempCat),i=J(a=>a.modalType),t=J(a=>a.formData),n=J(a=>a.setNestedFormData),q=J(a=>a.closeModal),y=S(a=>a.loading),F=S(a=>a.payments),C=S(a=>a.getDataPaymentsPlayer),P=S(a=>a.addPayment),T=S(a=>a.editPayment),I=S(a=>a.deletePayment),N=S(a=>a.getDataFilter),E=be(a=>a.getDataPlayers);re.useEffect(()=>{var a,l,r,j,v,p,c,u,m,g,b,f,h,M,w,B,z,G,H,K,Q,V,W,Y,Z,ee,ae,oe,te,le,se,ne;n("pagos.0.tipo","Inscripción"),n("pagos.1.tipo","Equipamiento"),n("pagos.2.tipo","Pesaje"),(l=(a=t.pagos)==null?void 0:a[0])!=null&&l.beca||n("pagos.0.beca","0"),(j=(r=t.pagos)==null?void 0:r[0])!=null&&j.descuento||n("pagos.0.descuento","0"),(p=(v=t.pagos)==null?void 0:v[0])!=null&&p.prorroga||n("pagos.0.prorroga","false"),(u=(c=t.pagos)==null?void 0:c[0])!=null&&u.fecha_limite||n("pagos.0.fecha_limite"),(g=(m=t.pagos)==null?void 0:m[0])!=null&&g.total_abonado||n("pagos.0.total_abonado","0"),(f=(b=t.pagos)==null?void 0:b[1])!=null&&f.total_abonado||n("pagos.1.total_abonado","0"),(M=(h=t.pagos)==null?void 0:h[2])!=null&&M.total_abonado||n("pagos.2.total_abonado","0"),(B=(w=t.pagos)==null?void 0:w[0])!=null&&B.estatus||n("pagos.0.estatus","pendiente"),(G=(z=t.pagos)==null?void 0:z[1])!=null&&G.estatus||n("pagos.1.estatus","pendiente"),(K=(H=t.pagos)==null?void 0:H[2])!=null&&K.estatus||n("pagos.2.estatus","pendiente"),(V=(Q=t.pagos)==null?void 0:Q[0])!=null&&V.fecha_pago||n("pagos.0.fecha_pago",null),(Y=(W=t.pagos)==null?void 0:W[1])!=null&&Y.fecha_pago||n("pagos.1.fecha_pago",null),(ee=(Z=t.pagos)==null?void 0:Z[2])!=null&&ee.fecha_pago||n("pagos.2.fecha_pago",null),(oe=(ae=t.pagos)==null?void 0:ae[0])!=null&&oe.metodo_pago||n("pagos.0.metodo_pago",null),(le=(te=t.pagos)==null?void 0:te[1])!=null&&le.metodo_pago||n("pagos.1.metodo_pago",null),(ne=(se=t.pagos)==null?void 0:se[2])!=null&&ne.metodo_pago||n("pagos.2.metodo_pago",null)},[t.pagos,n]);const O=async a=>{a.preventDefault();try{i==="add"?await P(t):i==="edit"&&await T(t)}catch(l){console.log(l)}finally{q()}},A=async a=>{await I(a),q()},k=async()=>{try{return(await E()).map(l=>({value:l.id,label:`${l.nombre} ${l.apellido_p} ${l.apellido_m}`,temporada:l.temporadaId,categoria:l.categoria}))}catch(a){return console.error("Error loading users:",a),[]}},$=async()=>{try{return(await _()).map(l=>({label:l.temporada,value:l.id}))}catch(a){return console.error("Error loading data:",a),[]}},D=async(a,l)=>{!a||!l||o(a,l)};return{payments:F,getDataPaymentsPlayer:C,loading:y,handleSubmit:O,handleDelete:A,loadOptions:k,loadOptionsTemporadas:$,handleFiltrar:()=>{const a=t.temporadaIdFilter,l=t.categoriaFilter;(!a||!l)&&pe.warning("Selecciona una temporada y una categoría"),D(a,l),N(a,l)},filterByTempCat:D,handleClearFilter:()=>{s({target:{name:"temporadaIdFilter",value:null}}),s({target:{name:"categoriaFilter",value:null}}),C()}}},U={inscriptionFields:[{required:!0,type:"number",label:"Beca (%) *",name:"beca"},{required:!0,type:"number",label:"Descuento por equipo propio (%) *",name:"descuento"},{required:!0,type:"select",label:"Estatus *",name:"estatus",opcSelect:[{value:"pendiente",label:"Pendiente"},{value:"pagado",label:"Pagado"}]},{required:!0,type:"number",label:"Submonto *",name:"submonto"},{required:!0,type:"number",label:"Monto final *",name:"monto"},{required:!1,type:"select",label:"Método de pago (si no se ha pagado, dejar vacía)",name:"metodo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}]},{required:!0,type:"select",label:"Prorroga *",name:"prorroga",opcSelect:[{value:"false",label:"No"},{value:"true",label:"Sí"}]},{required:!0,type:"date",label:"Fecha límite de pago *",name:"fecha_limite",condition:s=>s.prorroga==="true"},{required:!1,type:"date",label:"Fecha de pago (si no se ha pagado, dejar vacía)",name:"fecha_pago"},{required:!1,type:"select",label:"¿Abonará? *",name:"abono",opcSelect:[{value:"NO",label:"No"},{value:"SI",label:"Sí"}]},{required:!1,type:"number",label:"Total abonado",name:"total_abonado"}],equipamientoFields:[{required:!0,type:"select",label:"Estatus *",name:"estatus",opcSelect:[{value:"pendiente",label:"Pendiente"},{value:"pagado",label:"Pagado"}]},{required:!0,type:"number",label:"Monto total *",name:"monto"},{required:!1,type:"date",label:"Fecha de pago (si no se ha pagado, dejar vacía)",name:"fecha_pago"},{required:!1,type:"select",label:"Método de pago (si no se ha pagado, dejar vacía)",name:"metodo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}]},{required:!1,type:"select",label:"¿Abonará? *",name:"abono",opcSelect:[{value:"NO",label:"No"},{value:"SI",label:"Sí"}]},{required:!1,type:"number",label:"Total abonado",name:"total_abonado"}],pesajeFields:[{required:!0,type:"select",label:"Estatus *",name:"estatus",opcSelect:[{value:"pendiente",label:"Pendiente"},{value:"pagado",label:"Pagado"}]},{required:!0,type:"number",label:"Monto total *",name:"monto"},{required:!1,type:"date",label:"Fecha de pago (si no se ha pagado, dejar vacía)",name:"fecha_pago"},{required:!1,type:"select",label:"Método de pago (si no se ha pagado, dejar vacía)",name:"metodo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}]},{required:!1,type:"select",label:"¿Abonará? *",name:"abono",opcSelect:[{value:"NO",label:"No"},{value:"SI",label:"Sí"}]},{required:!1,type:"number",label:"Total abonado",name:"total_abonado"}],paymentsFields:[{required:!1,type:"number",label:"Total pagado *",name:"monto_total_pagado"},{required:!1,type:"number",label:"Total pendiente *",name:"monto_total_pendiente"},{required:!0,type:"number",label:"Monto Total *",name:"monto_total"}]},xe=()=>{var y,F,C,P,T,I,N,E,O,A,k,$,D,L,R;const{view:s,document:_,formData:o,handleNestedInputChange:i,handleInputChange:t}=de(),{loadOptions:n,loadOptionsTemporadas:q}=ie();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx(x,{text:"Jugador"}),e.jsx(d,{type:"async",label:"Selecciona el jugador",name:"jugador",required:!0,value:o.jugador||"",onChange:t,disabled:_?!0:s,loadOptions:n,classInput:"md:col-span-2"}),e.jsx(d,{type:"async",label:"Selecciona la temporada *",name:"temporadaId",required:!0,value:o.temporadaId,onChange:t,disabled:!0,loadOptions:q,classInput:"md:col-span-2"}),e.jsx(d,{type:"text",label:"Categoría *",name:"categoria",required:!0,value:o.categoria,onChange:t,disabled:!0,classInput:"md:col-span-2"}),e.jsx(x,{text:"Pago de inscripción"}),U.inscriptionFields.map(({type:a,label:l,name:r,required:j,opcSelect:v,condition:p,value:c})=>{var u,m,g,b,f,h,M,w,B;return(!p||p(((u=o.pagos)==null?void 0:u[0])||{}))&&e.jsx(d,{type:a,label:l,required:((g=(m=o.pagos)==null?void 0:m[0])==null?void 0:g.estatus)==="pagado"?!0:j,opcSelect:v,name:`pagos.0.${r}`,value:c||(((f=(b=o.pagos)==null?void 0:b[0])==null?void 0:f[r])??""),onChange:i,disabled:["monto","total_abonado"].includes(r)||((M=(h=o.pagos)==null?void 0:h[0])==null?void 0:M.total_abonado)>=((B=(w=o.pagos)==null?void 0:w[0])==null?void 0:B.monto)&&r==="abono"?!0:s},r)}),((F=(y=o.pagos)==null?void 0:y[0])==null?void 0:F.abono)==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"number",label:"Cantidad abonada *",required:!0,name:"cantidad_abono_ins",value:o.cantidad_abono_ins??"",onChange:t,disabled:s}),e.jsx(d,{type:"date",label:"Fecha del abono *",required:!0,name:"fecha_abono_ins",value:o.fecha_abono_ins??"",onChange:t,disabled:s}),e.jsx(d,{type:"select",label:"Método de pago *",required:!0,name:"metodo_pago_abono_ins",value:o.metodo_pago_abono_ins??"",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}],onChange:t,disabled:s})]}),((T=(P=(C=o.pagos)==null?void 0:C[0])==null?void 0:P.abonos)==null?void 0:T.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{text:"Abonos de inscripción"}),o.pagos[0].abonos.map((a,l)=>e.jsxs(e.Fragment,{children:[e.jsx(X,{amount:a.cantidad,date:a.fecha,method:a.metodo},l),e.jsx("hr",{className:"sm:grid-cols-3 gap-2 md:col-span-2"})]}))]}),e.jsx(x,{text:"Pago de equipamiento"}),U.equipamientoFields.map(({type:a,label:l,name:r,required:j,opcSelect:v})=>{var p,c,u,m,g,b,f,h;return e.jsx(d,{type:a,label:l,required:((c=(p=o.pagos)==null?void 0:p[1])==null?void 0:c.estatus)==="pagado"?!0:j,opcSelect:v,name:`pagos.1.${r}`,value:((m=(u=o.pagos)==null?void 0:u[1])==null?void 0:m[r])??"",onChange:i,disabled:["total_abonado"].includes(r)||((b=(g=o.pagos)==null?void 0:g[1])==null?void 0:b.total_abonado)>=((h=(f=o.pagos)==null?void 0:f[1])==null?void 0:h.monto)&&r==="abono"?!0:s},r)}),((N=(I=o.pagos)==null?void 0:I[1])==null?void 0:N.abono)==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"number",label:"Cantidad abonada *",required:!0,name:"cantidad_abono_equipamiento",value:o.cantidad_abono_equipamiento??"",onChange:t,disabled:s}),e.jsx(d,{type:"date",label:"Fecha del abono *",required:!0,name:"fecha_abono_equipamiento",value:o.fecha_abono_equipamiento??"",onChange:t,disabled:s}),e.jsx(d,{type:"select",label:"Método de pago *",required:!0,name:"metodo_pago_abono_equipamiento",value:o.metodo_pago_abono_equipamiento??"",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}],onChange:t,disabled:s})]}),((A=(O=(E=o.pagos)==null?void 0:E[1])==null?void 0:O.abonos)==null?void 0:A.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{text:"Abonos de equipamiento"}),o.pagos[1].abonos.map((a,l)=>e.jsxs(e.Fragment,{children:[e.jsx(X,{amount:a.cantidad,date:a.fecha,method:a.metodo},l),e.jsx("hr",{className:"sm:grid-cols-3 gap-2 md:col-span-2"})]}))]}),e.jsx(x,{text:"Pago de pesaje"}),U.pesajeFields.map(({type:a,label:l,name:r,required:j,opcSelect:v})=>{var p,c,u,m,g,b,f,h;return e.jsx(d,{type:a,label:l,required:((c=(p=o.pagos)==null?void 0:p[2])==null?void 0:c.estatus)==="pagado"?!0:j,opcSelect:v,name:`pagos.2.${r}`,value:((m=(u=o.pagos)==null?void 0:u[2])==null?void 0:m[r])??"",onChange:i,disabled:["total_abonado"].includes(r)||((b=(g=o.pagos)==null?void 0:g[2])==null?void 0:b.total_abonado)>=((h=(f=o.pagos)==null?void 0:f[2])==null?void 0:h.monto)&&r==="abono"?!0:s},r)}),(($=(k=o.pagos)==null?void 0:k[2])==null?void 0:$.abono)==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"number",label:"Cantidad abonada *",required:!0,name:"cantidad_abono_pesaje",value:o.cantidad_abono_pesaje??"",onChange:t,disabled:s}),e.jsx(d,{type:"date",label:"Fecha del abono *",required:!0,name:"fecha_abono_pesaje",value:o.fecha_abono_pesaje??"",onChange:t,disabled:s}),e.jsx(d,{type:"select",label:"Método de pago *",required:!0,name:"metodo_pago_abono_pesaje",value:o.metodo_pago_abono_pesaje??"",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"transferencia bancaria",label:"Transferencia bancaria"},{value:"tarjeta",label:"Tarjeta de crédito/débito"},{value:"efectivo",label:"Efectivo"},{value:"cheques",label:" Cheques"}],onChange:t,disabled:s})]}),((R=(L=(D=o.pagos)==null?void 0:D[2])==null?void 0:L.abonos)==null?void 0:R.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{text:"Abonos de pesaje"}),o.pagos[2].abonos.map((a,l)=>e.jsxs(e.Fragment,{children:[e.jsx(X,{amount:a.cantidad,date:a.fecha,method:a.metodo},l),e.jsx("hr",{className:"sm:grid-cols-3 gap-2 md:col-span-2"})]}))]}),e.jsx(x,{text:"Pagos"}),U.paymentsFields.map(({type:a,label:l,name:r,required:j,opcSelect:v})=>e.jsx(d,{type:a,label:l,required:j,opcSelect:v,name:r,value:o[r]??"",onChange:i,disabled:r==="monto_total"?!0:s},r))]}),e.jsx("hr",{className:"text-gray-300"}),s?e.jsx(ye,{}):e.jsx(ce,{})]})},_e=({formData:s,handleInputChange:_,view:o,loadOptionsTemporadas:i,categoriaOptionsFilter:t,handleFiltrar:n,handleClearFilter:q})=>{var y;return e.jsxs("div",{className:"mb-6 bg-white shadow-md rounded-md p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx(x,{text:"Puedes filtrar a los jugadores por temporada y categorías"})}),e.jsx("div",{className:"mb-4",children:e.jsx(d,{type:"async",label:"Selecciona la temporada",name:"temporadaIdFilter",required:!0,value:s.temporadaIdFilter,onChange:_,disabled:o,loadOptions:i})}),((y=s.temporadaIdFilter)==null?void 0:y.value)!==""&&e.jsx(d,{type:"select",label:"Selecciona la categoría",name:"categoriaFilter",required:!0,value:s.categoriaFilter,opcSelect:t,onChange:_,disabled:o}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 items-center justify-center",children:[e.jsxs("button",{onClick:n,className:"rounded-sm text-white font-medium py-2 px-3 bg-[#328E6E] hover:bg-[#24644e] transition-all cursor-pointer mt-4 flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),"Filtrar jugadores"]}),e.jsxs("button",{onClick:q,className:"rounded-sm text-white font-medium py-2 px-3 bg-[#E78B48] hover:bg-[#c4763e] transition-all cursor-pointer mt-4 flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5"}),"Limpiar filtros"]})]})]})},qe=[{key:"inscripcion",name:"Inscripción"},{key:"equipamiento",name:"Equipamiento"},{key:"pesaje",name:"Pesaje"},{key:"nombre",name:"Jugador"}];function He(){const{modalType:s,currentItem:_,formData:o,handleInputChange:i,view:t,categoriaOptionsFilter:n}=de(),{payments:q,loading:y,getDataPaymentsPlayer:F,handleSubmit:C,handleDelete:P,handleFiltrar:T,handleClearFilter:I,loadOptionsTemporadas:N}=ie(i);return re.useEffect(()=>{(async()=>await F())()},[F]),e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(_e,{formData:o,handleInputChange:i,view:t,loadOptionsTemporadas:N,categoriaOptionsFilter:n,handleFiltrar:T,handleClearFilter:I}),e.jsx(me,{columns:qe,data:q,title:"Pagos de jugadores",loading:y}),(s==="add"||s==="edit"||s==="view")&&e.jsx(ue,{handleSubmit:C,Inputs:e.jsx(xe,{})}),s==="delete"&&_&&e.jsx(ge,{handleDelete:P})]})}export{He as default};
